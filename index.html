<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Prueba CORS Supabase</title>
</head>
<body style="font-family: sans-serif; padding: 2rem;">
  <h2>üß™ Prueba CORS - actualizar_nip</h2>
  <p>Haz clic para enviar un <strong>POST</strong> de prueba a Supabase.</p>
  <button onclick="probarCORS()">Probar solicitud</button>

  <pre id="resultado" style="margin-top: 2rem; white-space: pre-wrap; background: #f9f9f9; padding: 1rem; border-radius: 8px;"></pre>

  <script>
    async function probarCORS() {
      const resultado = document.getElementById("resultado");
      resultado.textContent = "Enviando solicitud...";

      try {
        const res = await fetch("https://ldjrpfsbpcfninntffoj.supabase.co/functions/v1/actualizar_nip", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            nip_admin: "1234",
            nombre: "UsuarioPrueba",
            nuevo_nip: "0000",
            nuevas_unidades: ["C03430"]
          })
        });

        const texto = await res.text();
        resultado.textContent = `C√≥digo: ${res.status}\n\nRespuesta:\n${texto}`;
      } catch (err) {
        resultado.textContent = `‚ùå Error: ${err}`;
      }
    }
  </script>
</body>
</html>
